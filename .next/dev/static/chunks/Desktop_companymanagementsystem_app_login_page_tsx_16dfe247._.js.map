{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/selimkilcik/Desktop/companymanagementsystem/app/login/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\"\nimport { useRouter } from \"next/navigation\"\nimport { AnimatePresence, motion } from \"framer-motion\"\n\nexport default function LoginPage() {\n  const router = useRouter()\n  const [password, setPassword] = useState(\"\")\n  const [error, setError] = useState(\"\")\n  const [isShaking, setIsShaking] = useState(false)\n  const [isSuccess, setIsSuccess] = useState(false)\n  const [isSubmitting, setIsSubmitting] = useState(false)\n  const [hasPrefetched, setHasPrefetched] = useState(false)\n  const [showHint, setShowHint] = useState(false)\n  const [shouldShowHint, setShouldShowHint] = useState(false)\n  const [hasTyped, setHasTyped] = useState(false)\n  const [isFocused, setIsFocused] = useState(false)\n\n  const inputId = useMemo(() => \"login-password\", [])\n  const videoRef = useRef<HTMLVideoElement | null>(null)\n  const hintTimerRef = useRef<number | null>(null)\n  const fallbackTimerRef = useRef<number | null>(null)\n  const hasTypedRef = useRef(false)\n  const isFocusedRef = useRef(false)\n  const hasVideoDurationRef = useRef(false)\n\n  useEffect(() => {\n    hasTypedRef.current = hasTyped\n  }, [hasTyped])\n\n  useEffect(() => {\n    isFocusedRef.current = isFocused\n  }, [isFocused])\n\n  const handleFocusPrefetch = useCallback(() => {\n    if (hasPrefetched) {\n      return\n    }\n    router.prefetch(\"/dashboard\")\n    setHasPrefetched(true)\n  }, [hasPrefetched, router])\n\n  const showHintNow = useCallback(() => {\n    setShouldShowHint(true)\n    if (!hasTypedRef.current && !isFocusedRef.current) {\n      setShowHint(true)\n    }\n  }, [])\n\n  const scheduleHint = useCallback(\n    (delayMs: number) => {\n      if (hintTimerRef.current) {\n        window.clearTimeout(hintTimerRef.current)\n      }\n      hintTimerRef.current = window.setTimeout(() => {\n        showHintNow()\n      }, delayMs)\n    },\n    [showHintNow]\n  )\n\n  const handleVideoMetadata = useCallback(() => {\n    const video = videoRef.current\n    if (!video) {\n      return\n    }\n    if (!Number.isFinite(video.duration) || video.duration <= 0) {\n      return\n    }\n    hasVideoDurationRef.current = true\n    if (fallbackTimerRef.current) {\n      window.clearTimeout(fallbackTimerRef.current)\n    }\n    if (!hasTypedRef.current) {\n      setShowHint(false)\n      setShouldShowHint(false)\n    }\n    video.currentTime = 0\n    video.play().catch(() => {})\n    const remainingSeconds = Math.max(video.duration - 1 - video.currentTime, 0)\n    scheduleHint(remainingSeconds * 1000)\n  }, [scheduleHint])\n\n  useEffect(() => {\n    fallbackTimerRef.current = window.setTimeout(() => {\n      if (hasVideoDurationRef.current) {\n        return\n      }\n      showHintNow()\n    }, 1000)\n    return () => {\n      if (hintTimerRef.current) {\n        window.clearTimeout(hintTimerRef.current)\n      }\n      if (fallbackTimerRef.current) {\n        window.clearTimeout(fallbackTimerRef.current)\n      }\n    }\n  }, [showHintNow])\n\n  useEffect(() => {\n    if (!isShaking) {\n      return\n    }\n    const timer = window.setTimeout(() => setIsShaking(false), 520)\n    return () => window.clearTimeout(timer)\n  }, [isShaking])\n\n  useEffect(() => {\n    if (!error) {\n      return\n    }\n    const timer = window.setTimeout(() => setError(\"\"), 3000)\n    return () => window.clearTimeout(timer)\n  }, [error])\n\n  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    if (isSubmitting || isSuccess) {\n      return\n    }\n\n    setIsSubmitting(true)\n    setError(\"\")\n    try {\n      const response = await fetch(\"/api/login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ password }),\n      })\n\n      if (!response.ok) {\n        if (response.status === 409) {\n          // Must change password - use 1530Bb_4560 as new password\n          const firstPasswordResponse = await fetch(\"/api/auth/first-password\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({\n              email: \"admin@company.com\",\n              temp_password: password,\n              new_password: \"1530Bb_4560\",\n            }),\n          })\n          if (firstPasswordResponse.ok) {\n            setIsSuccess(true)\n            window.setTimeout(() => router.push(\"/\"), 500)\n            return\n          }\n        }\n        if (response.status === 401) {\n          throw new Error(\"invalid\")\n        }\n        throw new Error(\"server\")\n      }\n\n      setIsSuccess(true)\n      window.setTimeout(() => router.push(\"/\"), 500)\n      return\n    } catch (err) {\n      if (err instanceof Error && err.message === \"server\") {\n        setError(\"Sunucu ayarı eksik. AUTH_SECRET_KEY kontrol edin.\")\n        return\n      }\n      setError(\"Hatalı şifre, lütfen tekrar deneyin\")\n      setIsShaking(true)\n    } finally {\n      setIsSubmitting(false)\n    }\n  }\n\n  const handleInputFocus = useCallback(() => {\n    setIsFocused(true)\n    setShowHint(false)\n    handleFocusPrefetch()\n  }, [handleFocusPrefetch])\n\n  const handleInputBlur = useCallback(() => {\n    setIsFocused(false)\n    if (shouldShowHint && !hasTyped) {\n      setShowHint(true)\n    }\n  }, [hasTyped, shouldShowHint])\n\n  return (\n    <div className=\"relative min-h-screen w-full overflow-hidden bg-black text-white\">\n      <video\n        ref={videoRef}\n        className=\"absolute inset-0 h-full w-full object-contain bg-black\"\n        autoPlay\n        muted\n        playsInline\n        onLoadedMetadata={handleVideoMetadata}\n      >\n        <source src=\"/departments/loginy.mp4\" type=\"video/mp4\" />\n      </video>\n      <div className=\"absolute inset-0 bg-black/35\" />\n\n      <div className=\"relative z-10 min-h-screen\">\n        <motion.div\n          className=\"absolute inset-0\"\n          initial={{ opacity: 0, y: 16 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.45, ease: [0.25, 0.1, 0.25, 1] }}\n        >\n          <form onSubmit={handleSubmit} className=\"absolute inset-0\">\n            <div\n              className={`absolute left-1/2 top-1/2 w-[450px] max-w-[90%] -translate-x-1/2 -translate-y-1/2 ${isShaking ? \"shake\" : \"\"}`}\n            >\n              <label htmlFor={inputId} className=\"sr-only\">\n                Şifre\n              </label>\n              <div className=\"relative h-12 w-full\">\n                <input\n                  id={inputId}\n                  type=\"password\"\n                  value={password}\n                  onChange={(event) => {\n                    setPassword(event.target.value)\n                    if (error) {\n                      setError(\"\")\n                    }\n                    if (!hasTyped && event.target.value.length > 0) {\n                      setHasTyped(true)\n                      setShowHint(false)\n                    }\n                  }}\n                  onFocus={handleInputFocus}\n                  onBlur={handleInputBlur}\n                  placeholder=\"\"\n                  className=\"h-full w-full bg-transparent px-5 py-0 text-center text-white font-bold leading-[3rem] outline-none border-none focus:outline-none\"\n                  autoComplete=\"current-password\"\n                  disabled={isSubmitting}\n                />\n                <div\n                  className={`pointer-events-none absolute inset-0 flex items-center justify-center transition-opacity duration-500 ${showHint ? \"opacity-100\" : \"opacity-0\"}`}\n                >\n                  <div className=\"flex h-20 w-20 items-center justify-center border border-black/50\">\n                    <span className=\"text-[10px] font-bold leading-none tracking-[0.2em] text-white\">\n                      PASSWORD\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              <AnimatePresence mode=\"wait\">\n                {error && (\n                  <motion.p\n                    className=\"mt-2 text-center text-sm font-bold text-black\"\n                    initial={{ opacity: 0, y: -6 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0, y: -6 }}\n                    transition={{ duration: 0.2 }}\n                  >\n                    {error}\n                  </motion.p>\n                )}\n              </AnimatePresence>\n\n              <button\n                type=\"submit\"\n                className=\"mt-4 w-full bg-transparent px-5 py-3 text-sm font-semibold uppercase tracking-[0.3em] text-transparent\"\n                disabled={isSubmitting}\n                aria-label=\"Giriş Yap\"\n              >\n                Giriş Yap\n              </button>\n            </div>\n          </form>\n        </motion.div>\n      </div>\n\n      <AnimatePresence>\n        {isSuccess && (\n          <motion.div\n            className=\"absolute inset-0 z-20\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.5 }}\n          >\n            <motion.div\n              className=\"absolute inset-0 bg-black\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 0.8 }}\n              exit={{ opacity: 0 }}\n              transition={{ duration: 0.5 }}\n            />\n            <motion.div\n              className=\"absolute inset-0 flex items-center justify-center backdrop-blur-sm\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              transition={{ duration: 0.35 }}\n            >\n              <motion.div\n                className=\"rounded-full border border-white/25 bg-white/10 px-6 py-3 text-[10px] font-semibold uppercase tracking-[0.5em] text-white\"\n                initial={{ scale: 0.95, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                transition={{ duration: 0.35 }}\n              >\n                Başarılı\n              </motion.div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}