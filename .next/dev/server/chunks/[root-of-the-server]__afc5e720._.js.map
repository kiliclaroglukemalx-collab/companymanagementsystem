{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/selimkilcik/Desktop/companymanagementsystem/app/api/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { SignJWT } from \"jose\"\n\nconst AUTH_COOKIE = \"cms-auth\"\n\nexport async function POST(request: Request) {\n  const adminPassword = process.env.ADMIN_PASSWORD\n  const secret = process.env.AUTH_SECRET_KEY\n  if (!adminPassword || !secret) {\n    return NextResponse.json({ error: \"Server misconfigured\" }, { status: 500 })\n  }\n\n  const body = await request.json().catch(() => null)\n  const password = body?.password\n\n  if (password !== adminPassword) {\n    return NextResponse.json({ error: \"Invalid credentials\" }, { status: 401 })\n  }\n\n  const token = await new SignJWT({ role: \"admin\" })\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(\"1d\")\n    .sign(new TextEncoder().encode(secret))\n\n  const response = NextResponse.json({ ok: true })\n  response.cookies.set({\n    name: AUTH_COOKIE,\n    value: token,\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"strict\",\n    path: \"/\",\n    maxAge: 60 * 60 * 24,\n  })\n  return response\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,cAAc;AAEb,eAAe,KAAK,OAAgB;IACzC,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc;IAChD,MAAM,SAAS,QAAQ,GAAG,CAAC,eAAe;IAC1C,IAAI,CAAC,iBAAiB,CAAC,QAAQ;QAC7B,OAAO,sLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;IAEA,MAAM,OAAO,MAAM,QAAQ,IAAI,GAAG,KAAK,CAAC,IAAM;IAC9C,MAAM,WAAW,MAAM;IAEvB,IAAI,aAAa,eAAe;QAC9B,OAAO,sLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAsB,GAAG;YAAE,QAAQ;QAAI;IAC3E;IAEA,MAAM,QAAQ,MAAM,IAAI,wMAAO,CAAC;QAAE,MAAM;IAAQ,GAC7C,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC,IAAI,cAAc,MAAM,CAAC;IAEjC,MAAM,WAAW,sLAAY,CAAC,IAAI,CAAC;QAAE,IAAI;IAAK;IAC9C,SAAS,OAAO,CAAC,GAAG,CAAC;QACnB,MAAM;QACN,OAAO;QACP,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,MAAM;QACN,QAAQ,KAAK,KAAK;IACpB;IACA,OAAO;AACT"}}]
}